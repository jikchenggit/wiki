---
title: 恢复失败的主服务器
description: 恢复失败的主服务器
published: true
date: 2021-08-23T03:49:13.416Z
tags: 恢复失败的主服务器
editor: markdown
dateCreated: 2020-08-26T15:14:47.971Z
---

# 恢复失败的主服务器

如果主服务器失败，则无法访问Greenplum数据库系统，并且WAL复制停止。使用[gpactivatestandby]()激活备用主服务器。在激活备用主服务器时，Greenplum数据库重新构造上次成功提交事务时的主服务器状态。

这些步骤假设为系统配置了一个备用主主机。参见启用主备参数。

## 激活备用主服务器
1. 激活的standby主机运行gpactivatestandby实用程序。例如:
```
$ gpactivatestandby -d /data/master/gpseg-1

```
其中-d指定您正在激活的standby主机的数据目录。
激活备用服务器后，它将成为Greenplum数据库数组的活动主服务器或主服务器。


2. 在实用程序完成后，运行带有-b选项的gpstate，以显示系统状态的摘要:
```
$ gpstate -b
```
主实例状态应该是活动的。如果没有配置备用主服务器，该命令将显示未为备用主服务器状态配置的备用主服务器。如果您配置了一个新的备用主服务器，它的状态是被动的。

3. 可选:如果在激活之前的备用主服务器时还没有这样做，可以在活动主服务器上运行gpinitstandby来配置新的备用主服务器。

> 重要提示:必须初始化一个新的备用主服务器，才能继续提供主服务器镜像。
有关恢复原始主服务器和备用主服务器配置的信息，请参见[在恢复后恢复主服务器镜像](/zh/greenplum/系统管理/管理Greenplum系统/高可用性和数据一致性/恢复失败的主服务器/在恢复后恢复主服务器镜像)。


[在恢复后恢复主镜像](/zh/greenplum/系统管理/管理Greenplum系统/高可用性和数据一致性/恢复失败的主服务器/在恢复后恢复主服务器镜像)

